---
layout: page
title: "항공사 MLOps 시스템 구축"
description: |
  2023\.07 ~ 2023\.10  
  항공사에서 MLOps 시스템을 구축하고, 기존에 수기로 운영 중인 ML모델을 MLOps 시스템에 마이그레이션하였습니다.
hide_description: false
sitemap: false
---

0. Table of Contents
{:toc}


## Overview

A항공사는 기존에 수기로 운영 중인 라운지별 이용객 수 예측 모델을 MLOps 환경에 마이그레이션하는 것을 원했으며, 이에 따라 신규로 MLOps 시스템을 구축하고자 하였습니다. 해당 사업에서 저는 ML모델을 최소한의 사람의 손을 거치며 자동 운영 가능한 MLOps 아키텍쳐를 구상하고 이를 AWS 네이티브 서비스를 활용하여 구축하였습니다.

MLOps 시스템을 구성하는 파이프라인은 추론, 학습, 모니터링 파이프라인으로 구성하였으며 Sagemaker Pipeline을 활용하여 구축하였습니다. 파이프라인 내 Sagemaker Job에서 실행되는 소스코드는 Python으로 개발하였으며, Preprocess, Train, Postprocess, Monitoring의 4개 커스텀 클래스로 구성하였습니다. 

Sagemaker 외에 파이프라인 스케줄링을 위해 Lambda 및 EventBridge를 활용하였으며, A항공사의 CI/CD 표준인 BitBucket, Jenkins를 활용하여 CI/CD를 구축하였습니다. 또한 학습 파이프라인 트리거 알림 및 모니터링 파이프라인 결과 알림을 위해 AWS SNS를 활용하였습니다.


## Process

A항공사는 라운지별 이용객 수 예측 모델을 라운지 종류(MR, PR, FR)에 따라 3개로 나누어 운영하고 있었습니다. 이에 따라, 신규 구축할 MLOps 시스템은 3개의 모델 운영을 고려하여 구성하였습니다. MLOps 시스템을 구성하는 파이프라인은 상세하게는, 5개의 파이프라인으로 구성되어 있습니다.

1. 추론 파이프라인 : MR, PR, FR 라운지 3개 모델의 추론 결과를 S3에 적재합니다. 
  - 모든 라운지가 같은 시각에 추론 데이터가 필요하므로, 3개 모델의 추론 파이프라인을 통합하여 하나의 파이프라인으로 구성하였습니다. 
  - 매일 07시에 타 시스템이 MLOps 유관 팀의 AWS 계정 S3로 데이터를 적재하며, Lambda가 해당 이벤트를 감지하여 추론 파이프라인을 실행합니다.
2. 학습 파이프라인 : 각 라운지별 이용객 수 예측 모델을 학습하고, 모델 아티팩트를 S3 내 경로에 저장합니다. 
  - Sagemaker AutoML을 이용하여 구성하였습니다. 라운지별 모델 학습은 각 모델의 모니터링 결과에 따라 따로 일어날 수 있으므로, 각 라운지별로 학습 파이프라인을 구성하였습니다.
  - 모니터링 파이프라인의 결과에 따라 학습 파이프라인이 실행됩니다. 
3. 모니터링 파이프라인 : MR, PR, FR 라운지 3개 모델의 일주일치 추론 결과를 바탕으로 성능을 확인합니다. 
  - 같은 시점에 3개 모델의 모니터링 결과를 확인하므로 3개 모델의 모니터링 파이프라인을 통합하여 하나의 파이프라인으로 구성하였습니다.
  - 매주 일요일 오후 8시 EventBridge를 통해서 모니터링 파이프라인을 실행하며, 특정 모델의 성능이 기준치에 미달한다면 해당 모델의 학습 파이프라인을 실행합니다. 

위 시스템의 개괄적인 아키텍쳐는 아래와 같습니다.





Train 클래스 내에서는 AutoML을 활용한 학습과 학습된 모델의 저장, 그리고 학습된 모델의 검증 데이터셋에 대한 성능 지표를 저장하는 


## Meaning




## Skills

Python, AWS(Sagemaker, S3)

Go back to [Myeong Hyeon Son](/about/#projects){:.heading.flip-title}
{:.read-more}